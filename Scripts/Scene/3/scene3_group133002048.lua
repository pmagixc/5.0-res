-- 基础信息
local base_info = {
	group_id = 133002048
}

--================================================================
-- 
-- 配置
-- 
--================================================================

-- 怪物
monsters = {
}

-- NPC
npcs = {
}

-- 装置
gadgets = {
	{ config_id = 48001, gadget_id = 70690017, pos = { x = 1330.456, y = 349.769, z = -911.746 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 5, area_id = 10 },
	{ config_id = 48002, gadget_id = 70690001, pos = { x = 1330.382, y = 364.704, z = -906.642 }, rot = { x = 0.713, y = 359.196, z = 0.000 }, level = 1, area_id = 10 },
	{ config_id = 48004, gadget_id = 70690001, pos = { x = 1330.186, y = 364.529, z = -892.644 }, rot = { x = 0.713, y = 359.196, z = 0.000 }, level = 1, area_id = 10 },
	{ config_id = 48006, gadget_id = 70690001, pos = { x = 1329.990, y = 364.355, z = -878.647 }, rot = { x = 0.713, y = 359.196, z = 0.000 }, level = 1, area_id = 10 },
	{ config_id = 48009, gadget_id = 70690017, pos = { x = 1335.642, y = 344.124, z = -778.436 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1, area_id = 10 },
	{ config_id = 48015, gadget_id = 70690001, pos = { x = 1331.713, y = 356.901, z = -837.017 }, rot = { x = 359.007, y = 6.179, z = 359.544 }, level = 1, area_id = 10 },
	{ config_id = 48016, gadget_id = 70690001, pos = { x = 1332.468, y = 357.022, z = -830.059 }, rot = { x = 359.007, y = 6.178, z = 359.544 }, level = 1, area_id = 10 },
	{ config_id = 48017, gadget_id = 70690001, pos = { x = 1333.220, y = 357.143, z = -823.101 }, rot = { x = 359.007, y = 6.178, z = 359.544 }, level = 1, area_id = 10 },
	{ config_id = 48018, gadget_id = 70690001, pos = { x = 1333.975, y = 357.264, z = -816.142 }, rot = { x = 359.007, y = 6.178, z = 359.544 }, level = 1, area_id = 10 },
	{ config_id = 48019, gadget_id = 70690001, pos = { x = 1334.726, y = 357.386, z = -809.184 }, rot = { x = 359.007, y = 6.178, z = 359.544 }, level = 1, area_id = 10 },
	{ config_id = 48025, gadget_id = 70690001, pos = { x = 1335.642, y = 352.853, z = -778.436 }, rot = { x = 270.052, y = 6.442, z = 0.000 }, level = 1, area_id = 10 },
	{ config_id = 48026, gadget_id = 70690001, pos = { x = 1335.643, y = 359.853, z = -778.428 }, rot = { x = 270.056, y = 6.391, z = 0.000 }, level = 1, area_id = 10 },
	{ config_id = 48027, gadget_id = 70690001, pos = { x = 1335.644, y = 366.853, z = -778.421 }, rot = { x = 270.056, y = 6.391, z = 0.000 }, level = 1, area_id = 10 },
	{ config_id = 48028, gadget_id = 70690001, pos = { x = 1335.644, y = 373.853, z = -778.413 }, rot = { x = 270.056, y = 6.391, z = 0.000 }, level = 1, area_id = 10 },
	{ config_id = 48029, gadget_id = 70690001, pos = { x = 1335.645, y = 380.853, z = -778.406 }, rot = { x = 270.056, y = 6.391, z = 0.000 }, level = 1, area_id = 10 },
	{ config_id = 48034, gadget_id = 70690017, pos = { x = 1327.787, y = 387.810, z = -778.345 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1, area_id = 10 },
	{ config_id = 48035, gadget_id = 70690001, pos = { x = 1320.788, y = 398.228, z = -778.322 }, rot = { x = 358.992, y = 270.188, z = 0.000 }, level = 1, area_id = 10 },
	{ config_id = 48036, gadget_id = 70690001, pos = { x = 1313.789, y = 398.351, z = -778.299 }, rot = { x = 358.992, y = 270.188, z = 0.000 }, level = 1, area_id = 10 },
	{ config_id = 48037, gadget_id = 70690001, pos = { x = 1306.790, y = 398.474, z = -778.276 }, rot = { x = 358.992, y = 270.188, z = 0.000 }, level = 1, area_id = 10 },
	{ config_id = 48041, gadget_id = 70690001, pos = { x = 1277.697, y = 396.467, z = -778.262 }, rot = { x = 359.782, y = 269.985, z = 0.000 }, level = 1, area_id = 10 },
	{ config_id = 48043, gadget_id = 70690001, pos = { x = 1284.639, y = 396.441, z = -778.260 }, rot = { x = 359.782, y = 269.985, z = 0.000 }, level = 1, area_id = 10 },
	{ config_id = 48044, gadget_id = 70690001, pos = { x = 1269.865, y = 396.497, z = -778.264 }, rot = { x = 359.782, y = 269.985, z = 0.000 }, level = 1, area_id = 10 },
	{ config_id = 48052, gadget_id = 70690001, pos = { x = 1229.197, y = 393.039, z = -768.506 }, rot = { x = 1.843, y = 344.290, z = 0.000 }, level = 1, area_id = 10 }
}

-- 区域
regions = {
	{ config_id = 48011, shape = RegionShape.SPHERE, radius = 25, pos = { x = 1209.193, y = 387.468, z = -721.992 }, area_id = 10 }
}

-- 触发器
triggers = {
	{ config_id = 1048007, name = "GROUP_LOAD_48007", event = EventType.EVENT_GROUP_LOAD, source = "", condition = "", action = "action_EVENT_GROUP_LOAD_48007" },
	{ config_id = 1048010, name = "TIME_AXIS_PASS_48010", event = EventType.EVENT_TIME_AXIS_PASS, source = "T1", condition = "", action = "action_EVENT_TIME_AXIS_PASS_48010" },
	{ config_id = 1048011, name = "ENTER_REGION_48011", event = EventType.EVENT_ENTER_REGION, source = "", condition = "condition_EVENT_ENTER_REGION_48011", action = "action_EVENT_ENTER_REGION_48011" }
}

-- 变量
variables = {
}

-- 废弃数据
garbages = {
	gadgets = {
		{ config_id = 48003, gadget_id = 70690001, pos = { x = 1330.284, y = 364.617, z = -899.643 }, rot = { x = 0.713, y = 359.196, z = 0.000 }, level = 1, area_id = 10 },
		{ config_id = 48005, gadget_id = 70690001, pos = { x = 1330.088, y = 364.442, z = -885.645 }, rot = { x = 0.713, y = 359.197, z = 0.000 }, level = 1, area_id = 10 },
		{ config_id = 48042, gadget_id = 70690001, pos = { x = 1284.598, y = 396.441, z = -778.260 }, rot = { x = 359.782, y = 269.985, z = 0.000 }, level = 1, area_id = 10 }
	}
}

--================================================================
-- 
-- 初始化配置
-- 
--================================================================

-- 初始化时创建
init_config = {
	suite = 1,
	end_suite = 0,
	rand_suite = false
}

--================================================================
-- 
-- 小组配置
-- 
--================================================================

suites = {
	{
		-- suite_id = 1,
		-- description = ,
		monsters = { },
		gadgets = { 48001, 48002, 48004, 48006, 48009, 48015, 48016, 48017, 48018, 48019, 48025, 48026, 48027, 48028, 48029, 48034, 48035, 48036, 48037, 48041, 48043, 48044, 48052 },
		regions = { 48011 },
		triggers = { "GROUP_LOAD_48007", "TIME_AXIS_PASS_48010", "ENTER_REGION_48011" },
		rand_weight = 100
	},
	{
		-- suite_id = 2,
		-- description = ,
		monsters = { },
		gadgets = { },
		regions = { },
		triggers = { },
		rand_weight = 100
	}
}

--================================================================
-- 
-- 触发器
-- 
--================================================================

-- 触发操作
function action_EVENT_GROUP_LOAD_48007(context, evt)
	-- 创建标识为"T1"，时间节点为{3}的时间轴，false用于控制该时间轴是否循环
	ScriptLib.InitTimeAxis(context, "T1", {3}, false)
	
	
	return 0
end

-- 触发操作
function action_EVENT_TIME_AXIS_PASS_48010(context, evt)
	-- 触发镜头注目，注目位置为坐标（1330.382，364.7037，-911.7459），持续时间为3秒，并且为强制注目形式，不广播其他玩家
		local pos = {x=1330.382, y=364.7037, z=-911.7459}
	  local pos_follow = {x=0, y=0, z=0}
	    if 0 ~= ScriptLib.BeginCameraSceneLook(context, { look_pos = pos, is_allow_input = true, duration = 3, is_force = true, is_broadcast = false, is_recover_keep_current = true, delay = 0,
	                                                      is_set_follow_pos = false, follow_pos = pos_follow, is_force_walk = false, is_change_play_mode = false,
	                                                      is_set_screen_XY = false, screen_x = 0, screen_y = 0 }) then
					ScriptLib.PrintContextLog(context, "@@ LUA_WARNING : active_cameraLook_Begin")
	        return -1
				end 
	
	-- 调用提示id为 400071 的提示UI，会显示在屏幕中央偏下位置，id索引自 ReminderData表格
	if 0 ~= ScriptLib.ShowReminder(context, 400071) then
	  ScriptLib.PrintContextLog(context, "@@ LUA_WARNING : active_reminder_ui")
		return -1
	end
	
	return 0
end

-- 触发条件
function condition_EVENT_ENTER_REGION_48011(context, evt)
	if evt.param1 ~= 48011 then return false end
	
	-- 判断角色数量不少于1
	if ScriptLib.GetRegionEntityCount(context, { region_eid = evt.source_eid, entity_type = EntityType.AVATAR }) < 1 then
		return false
	end
	
	return true
end

-- 触发操作
function action_EVENT_ENTER_REGION_48011(context, evt)
	-- 删除suite1的所有内容
	    ScriptLib.RemoveExtraGroupSuite(context, 133002048, 1)
	
	return 0
end