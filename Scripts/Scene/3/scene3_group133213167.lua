-- 基础信息
local base_info = {
	group_id = 133213167
}

--================================================================
-- 
-- 配置
-- 
--================================================================

-- 怪物
monsters = {
	{ config_id = 167049, monster_id = 25080301, pos = { x = -3237.045, y = 200.000, z = -3898.894 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 29, drop_tag = "浪人武士", disableWander = true, pose_id = 1, area_id = 12 }
}

-- NPC
npcs = {
}

-- 装置
gadgets = {
	{ config_id = 167001, gadget_id = 70220063, pos = { x = -3176.450, y = 200.582, z = -3921.921 }, rot = { x = 39.865, y = 19.016, z = 359.301 }, level = 27, area_id = 12 },
	{ config_id = 167002, gadget_id = 70220050, pos = { x = -3176.893, y = 200.674, z = -3922.106 }, rot = { x = 0.000, y = 225.345, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167003, gadget_id = 70220050, pos = { x = -3200.161, y = 201.336, z = -3926.932 }, rot = { x = 0.000, y = 129.426, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167004, gadget_id = 70220050, pos = { x = -3200.832, y = 201.430, z = -3925.493 }, rot = { x = 0.000, y = 44.815, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167005, gadget_id = 70220064, pos = { x = -3200.031, y = 201.508, z = -3925.931 }, rot = { x = 0.000, y = 102.406, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167006, gadget_id = 70220064, pos = { x = -3200.274, y = 201.871, z = -3927.933 }, rot = { x = 0.000, y = 333.387, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167007, gadget_id = 70220063, pos = { x = -3200.526, y = 202.064, z = -3927.595 }, rot = { x = 0.000, y = 94.386, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167008, gadget_id = 70220063, pos = { x = -3198.741, y = 201.244, z = -3927.368 }, rot = { x = 30.834, y = 74.442, z = 324.704 }, level = 27, area_id = 12 },
	{ config_id = 167009, gadget_id = 70220063, pos = { x = -3200.224, y = 201.783, z = -3928.911 }, rot = { x = 326.977, y = 185.888, z = 354.737 }, level = 27, area_id = 12 },
	{ config_id = 167010, gadget_id = 70220064, pos = { x = -3176.185, y = 200.567, z = -3922.503 }, rot = { x = 0.000, y = 102.406, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167011, gadget_id = 70220050, pos = { x = -3239.161, y = 201.209, z = -3886.971 }, rot = { x = 0.000, y = 164.617, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167012, gadget_id = 70220063, pos = { x = -3238.278, y = 201.035, z = -3886.563 }, rot = { x = 0.000, y = 157.133, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167013, gadget_id = 70220064, pos = { x = -3238.588, y = 201.054, z = -3887.097 }, rot = { x = 0.000, y = 161.575, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167014, gadget_id = 70220050, pos = { x = -3222.814, y = 206.631, z = -3914.508 }, rot = { x = 0.000, y = 124.909, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167015, gadget_id = 70220050, pos = { x = -3246.060, y = 200.938, z = -3873.922 }, rot = { x = 0.000, y = 34.286, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167016, gadget_id = 70220050, pos = { x = -3269.747, y = 212.448, z = -3928.702 }, rot = { x = 0.000, y = 207.185, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167017, gadget_id = 70220063, pos = { x = -3268.864, y = 212.275, z = -3928.294 }, rot = { x = 0.000, y = 199.701, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167018, gadget_id = 70220064, pos = { x = -3269.174, y = 212.293, z = -3928.828 }, rot = { x = 0.000, y = 204.143, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167019, gadget_id = 70220050, pos = { x = -3263.445, y = 200.692, z = -3950.254 }, rot = { x = 0.000, y = 164.617, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167020, gadget_id = 70220050, pos = { x = -3240.022, y = 200.281, z = -3932.645 }, rot = { x = 0.000, y = 59.821, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167021, gadget_id = 70220050, pos = { x = -3237.430, y = 208.081, z = -3967.641 }, rot = { x = 346.408, y = 239.821, z = 133.052 }, level = 27, area_id = 12 },
	{ config_id = 167022, gadget_id = 70220063, pos = { x = -3243.309, y = 200.712, z = -3950.641 }, rot = { x = 0.000, y = 157.133, z = 116.232 }, level = 27, area_id = 12 },
	{ config_id = 167023, gadget_id = 70220050, pos = { x = -3242.247, y = 201.496, z = -3965.222 }, rot = { x = 313.474, y = 309.556, z = 138.659 }, level = 27, area_id = 12 },
	{ config_id = 167024, gadget_id = 70220063, pos = { x = -3223.361, y = 209.846, z = -3977.934 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167025, gadget_id = 70220050, pos = { x = -3218.111, y = 207.159, z = -3949.270 }, rot = { x = 0.000, y = 164.617, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167026, gadget_id = 70220063, pos = { x = -3218.836, y = 206.983, z = -3948.513 }, rot = { x = 0.000, y = 157.133, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167027, gadget_id = 70220064, pos = { x = -3218.228, y = 207.041, z = -3948.521 }, rot = { x = 0.000, y = 267.243, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167028, gadget_id = 70220063, pos = { x = -3217.244, y = 206.972, z = -3950.697 }, rot = { x = 0.000, y = 157.133, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167029, gadget_id = 70220050, pos = { x = -3236.687, y = 216.293, z = -3943.460 }, rot = { x = 0.000, y = 21.388, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167030, gadget_id = 70220050, pos = { x = -3222.829, y = 206.676, z = -3914.493 }, rot = { x = 0.000, y = 113.912, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167031, gadget_id = 70220050, pos = { x = -3209.005, y = 210.904, z = -3931.994 }, rot = { x = 0.000, y = 183.859, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167032, gadget_id = 70220050, pos = { x = -3218.467, y = 218.152, z = -3938.079 }, rot = { x = 0.261, y = 60.784, z = 9.970 }, level = 27, area_id = 12 },
	{ config_id = 167033, gadget_id = 70220063, pos = { x = -3218.963, y = 218.453, z = -3940.738 }, rot = { x = 348.879, y = 157.259, z = 358.701 }, level = 27, area_id = 12 },
	{ config_id = 167034, gadget_id = 70220064, pos = { x = -3219.653, y = 218.446, z = -3941.085 }, rot = { x = 5.003, y = 266.804, z = 349.971 }, level = 27, area_id = 12 },
	{ config_id = 167035, gadget_id = 70220063, pos = { x = -3206.164, y = 227.366, z = -3954.436 }, rot = { x = 22.192, y = 181.547, z = 28.196 }, level = 27, area_id = 12 },
	{ config_id = 167036, gadget_id = 70220050, pos = { x = -3197.293, y = 225.956, z = -3959.021 }, rot = { x = 0.000, y = 164.617, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167037, gadget_id = 70220063, pos = { x = -3198.018, y = 225.795, z = -3958.265 }, rot = { x = 0.000, y = 157.133, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167038, gadget_id = 70220064, pos = { x = -3197.410, y = 225.876, z = -3958.272 }, rot = { x = 0.000, y = 267.243, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167039, gadget_id = 70220050, pos = { x = -3194.908, y = 225.194, z = -3957.653 }, rot = { x = 0.000, y = 164.617, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167040, gadget_id = 70220063, pos = { x = -3196.251, y = 225.189, z = -3957.474 }, rot = { x = 0.000, y = 157.133, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167041, gadget_id = 70220064, pos = { x = -3195.500, y = 225.107, z = -3957.238 }, rot = { x = 0.000, y = 267.243, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167042, gadget_id = 70220050, pos = { x = -3198.554, y = 225.221, z = -3956.611 }, rot = { x = 56.814, y = 164.617, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167043, gadget_id = 70220050, pos = { x = -3196.641, y = 224.871, z = -3955.193 }, rot = { x = 270.492, y = 164.617, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167044, gadget_id = 70220063, pos = { x = -3193.233, y = 213.063, z = -3951.400 }, rot = { x = 0.000, y = 157.133, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167045, gadget_id = 70220050, pos = { x = -3226.867, y = 201.024, z = -3988.663 }, rot = { x = 0.000, y = 164.617, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167046, gadget_id = 70220063, pos = { x = -3229.243, y = 201.367, z = -3987.967 }, rot = { x = 0.000, y = 157.133, z = 75.352 }, level = 27, area_id = 12 },
	{ config_id = 167047, gadget_id = 70220064, pos = { x = -3227.660, y = 200.937, z = -3988.408 }, rot = { x = 0.000, y = 267.243, z = 0.000 }, level = 27, area_id = 12 },
	{ config_id = 167051, gadget_id = 70211031, pos = { x = -3247.673, y = 204.173, z = -3885.227 }, rot = { x = 0.000, y = 29.360, z = 0.000 }, level = 26, drop_tag = "战斗超级稻妻", isOneoff = true, persistent = true, explore = { name = "chest", exp = 1 }, area_id = 12 }
}

-- 区域
regions = {
}

-- 触发器
triggers = {
	{ config_id = 1167048, name = "ANY_GADGET_DIE_167048", event = EventType.EVENT_ANY_GADGET_DIE, source = "", condition = "condition_EVENT_ANY_GADGET_DIE_167048", action = "action_EVENT_ANY_GADGET_DIE_167048" },
	{ config_id = 1167050, name = "ANY_MONSTER_DIE_167050", event = EventType.EVENT_ANY_MONSTER_DIE, source = "", condition = "condition_EVENT_ANY_MONSTER_DIE_167050", action = "action_EVENT_ANY_MONSTER_DIE_167050" }
}

-- 变量
variables = {
}

--================================================================
-- 
-- 初始化配置
-- 
--================================================================

-- 初始化时创建
init_config = {
	suite = 1,
	end_suite = 0,
	rand_suite = false
}

--================================================================
-- 
-- 小组配置
-- 
--================================================================

suites = {
	{
		-- suite_id = 1,
		-- description = ,
		monsters = { },
		gadgets = { 167001, 167002, 167003, 167004, 167005, 167006, 167007, 167008, 167009, 167010, 167011, 167012, 167013, 167014, 167015, 167016, 167017, 167018, 167019, 167020, 167021, 167022, 167023, 167024, 167025, 167026, 167027, 167028, 167029, 167030, 167031, 167032, 167033, 167034, 167035, 167036, 167037, 167038, 167039, 167040, 167041, 167042, 167043, 167044, 167045, 167046, 167047 },
		regions = { },
		triggers = { "ANY_GADGET_DIE_167048", "ANY_MONSTER_DIE_167050" },
		rand_weight = 100
	}
}

--================================================================
-- 
-- 触发器
-- 
--================================================================

-- 触发条件
function condition_EVENT_ANY_GADGET_DIE_167048(context, evt)
	-- 判断指定group组剩余gadget数量是否是7 
	if ScriptLib.CheckRemainGadgetCountByGroupId(context, {group_id = 133213167}) ~= 7 then
		return false
	end
	
	return true
end

-- 触发操作
function action_EVENT_ANY_GADGET_DIE_167048(context, evt)
	-- 延迟0秒刷怪
	if 0 ~= ScriptLib.CreateMonster(context, { config_id = 167049, delay_time = 0 }) then
	  ScriptLib.PrintContextLog(context, "@@ LUA_WARNING : create_monster")
	  return -1
	end
	
	-- 调用提示id为 400004 的提示UI，会显示在屏幕中央偏下位置，id索引自 ReminderData表格
	if 0 ~= ScriptLib.ShowReminder(context, 400004) then
	  ScriptLib.PrintContextLog(context, "@@ LUA_WARNING : active_reminder_ui")
		return -1
	end
	
	return 0
end

-- 触发条件
function condition_EVENT_ANY_MONSTER_DIE_167050(context, evt)
	-- 判断剩余怪物数量是否是0
	if ScriptLib.GetGroupMonsterCount(context) ~= 0 then
		return false
	end
	
	return true
end

-- 触发操作
function action_EVENT_ANY_MONSTER_DIE_167050(context, evt)
	-- 创建id为167051的gadget
	if 0 ~= ScriptLib.CreateGadget(context, { config_id = 167051 }) then
	  ScriptLib.PrintContextLog(context, "@@ LUA_WARNING : create_gadget")
	  return -1
	end
	
	return 0
end