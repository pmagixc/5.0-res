-- 基础信息
local base_info = {
	group_id = 111101098
}

--================================================================
-- 
-- 配置
-- 
--================================================================

-- 怪物
monsters = {
}

-- NPC
npcs = {
}

-- 装置
gadgets = {
	{ config_id = 98001, gadget_id = 70350083, pos = { x = 2279.418, y = 217.235, z = -1152.729 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 24, persistent = true },
	{ config_id = 98002, gadget_id = 70360096, pos = { x = 2222.857, y = 230.322, z = -1146.267 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 24 },
	{ config_id = 98003, gadget_id = 70360096, pos = { x = 2187.927, y = 233.416, z = -1095.687 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 24 },
	{ config_id = 98004, gadget_id = 70360096, pos = { x = 2212.672, y = 206.909, z = -1026.921 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 24 },
	{ config_id = 98005, gadget_id = 70360096, pos = { x = 2170.716, y = 200.626, z = -1002.106 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 24 },
	{ config_id = 98006, gadget_id = 70360096, pos = { x = 2111.340, y = 221.997, z = -1025.842 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 24 },
	-- 墙
	{ config_id = 98015, gadget_id = 70950011, pos = { x = 2314.450, y = 207.450, z = -1137.603 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	-- 墙
	{ config_id = 98016, gadget_id = 70950011, pos = { x = 2325.760, y = 207.124, z = -1138.025 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	-- 墙
	{ config_id = 98017, gadget_id = 70950011, pos = { x = 2340.550, y = 206.591, z = -1138.225 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	-- 墙
	{ config_id = 98018, gadget_id = 70950011, pos = { x = 2353.489, y = 206.591, z = -1146.350 }, rot = { x = 0.000, y = 44.219, z = 0.000 }, level = 1 },
	-- 墙
	{ config_id = 98019, gadget_id = 70950011, pos = { x = 2363.489, y = 207.910, z = -1157.640 }, rot = { x = 0.000, y = 55.574, z = 0.000 }, level = 1 },
	-- 墙
	{ config_id = 98020, gadget_id = 70950011, pos = { x = 2299.598, y = 208.439, z = -1137.946 }, rot = { x = 0.000, y = 343.156, z = 0.000 }, level = 1 },
	-- 墙
	{ config_id = 98021, gadget_id = 70950011, pos = { x = 2288.458, y = 212.264, z = -1141.295 }, rot = { x = 0.000, y = 339.387, z = 0.000 }, level = 1 },
	-- 墙
	{ config_id = 98022, gadget_id = 70950011, pos = { x = 2275.814, y = 213.320, z = -1147.131 }, rot = { x = 0.000, y = 326.687, z = 0.000 }, level = 1 },
	{ config_id = 98030, gadget_id = 70900321, pos = { x = 2305.259, y = 211.595, z = -1151.493 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	{ config_id = 98031, gadget_id = 70900321, pos = { x = 2323.212, y = 209.592, z = -1157.238 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	{ config_id = 98032, gadget_id = 70900321, pos = { x = 2314.829, y = 210.037, z = -1173.478 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	{ config_id = 98033, gadget_id = 70900321, pos = { x = 2340.645, y = 209.957, z = -1173.357 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	{ config_id = 98034, gadget_id = 70900321, pos = { x = 2340.645, y = 205.835, z = -1149.069 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	{ config_id = 98035, gadget_id = 70220055, pos = { x = 2346.444, y = 210.952, z = -1178.624 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	{ config_id = 98036, gadget_id = 70220055, pos = { x = 2346.444, y = 208.911, z = -1156.949 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	{ config_id = 98037, gadget_id = 70220055, pos = { x = 2335.995, y = 206.135, z = -1147.031 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	{ config_id = 98038, gadget_id = 70220055, pos = { x = 2346.444, y = 206.413, z = -1148.209 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	{ config_id = 98039, gadget_id = 70220055, pos = { x = 2324.469, y = 209.631, z = -1174.545 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	{ config_id = 98040, gadget_id = 70220055, pos = { x = 2329.744, y = 209.496, z = -1178.624 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	{ config_id = 98041, gadget_id = 70220055, pos = { x = 2346.444, y = 210.608, z = -1172.613 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	{ config_id = 98042, gadget_id = 70220055, pos = { x = 2302.336, y = 209.622, z = -1171.689 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	{ config_id = 98043, gadget_id = 70220055, pos = { x = 2320.141, y = 212.859, z = -1155.370 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	{ config_id = 98044, gadget_id = 70220055, pos = { x = 2296.671, y = 210.499, z = -1164.794 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	{ config_id = 98045, gadget_id = 70220003, pos = { x = 2321.952, y = 207.682, z = -1160.511 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	{ config_id = 98046, gadget_id = 70220003, pos = { x = 2337.619, y = 212.028, z = -1161.548 }, rot = { x = 0.000, y = 243.348, z = 0.000 }, level = 1 },
	{ config_id = 98047, gadget_id = 70220003, pos = { x = 2335.322, y = 209.272, z = -1181.181 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	{ config_id = 98048, gadget_id = 70220003, pos = { x = 2307.776, y = 209.768, z = -1174.821 }, rot = { x = 0.000, y = 288.826, z = 0.000 }, level = 1 },
	{ config_id = 98049, gadget_id = 70220003, pos = { x = 2311.862, y = 210.030, z = -1168.820 }, rot = { x = 0.000, y = 288.826, z = 0.000 }, level = 1 },
	{ config_id = 98050, gadget_id = 70220003, pos = { x = 2342.390, y = 210.409, z = -1176.785 }, rot = { x = 0.000, y = 302.795, z = 0.000 }, level = 1 },
	{ config_id = 98051, gadget_id = 70220003, pos = { x = 2321.953, y = 213.349, z = -1153.686 }, rot = { x = 0.000, y = 47.266, z = 0.000 }, level = 1 },
	{ config_id = 98052, gadget_id = 70220003, pos = { x = 2324.699, y = 212.250, z = -1161.733 }, rot = { x = 2.018, y = 87.557, z = 359.914 }, level = 1 },
	{ config_id = 98053, gadget_id = 70220003, pos = { x = 2326.896, y = 211.033, z = -1181.180 }, rot = { x = 0.000, y = 37.187, z = 0.000 }, level = 1 },
	{ config_id = 98054, gadget_id = 70900321, pos = { x = 2320.272, y = 211.308, z = -1181.024 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	{ config_id = 98055, gadget_id = 70220055, pos = { x = 2309.615, y = 209.591, z = -1171.689 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	{ config_id = 98056, gadget_id = 70690001, pos = { x = 2336.415, y = 212.138, z = -1151.837 }, rot = { x = 0.000, y = 98.109, z = 0.000 }, level = 1 },
	{ config_id = 98057, gadget_id = 70690001, pos = { x = 2339.636, y = 214.357, z = -1170.560 }, rot = { x = 0.000, y = 148.919, z = 0.000 }, level = 1 },
	{ config_id = 98058, gadget_id = 70690001, pos = { x = 2317.200, y = 215.775, z = -1155.707 }, rot = { x = 0.000, y = 117.409, z = 0.000 }, level = 1 },
	{ config_id = 98059, gadget_id = 70220003, pos = { x = 2298.733, y = 210.010, z = -1170.739 }, rot = { x = 0.000, y = 265.403, z = 0.000 }, level = 1 },
	{ config_id = 98060, gadget_id = 70220003, pos = { x = 2305.492, y = 210.030, z = -1163.480 }, rot = { x = 0.000, y = 280.805, z = 0.000 }, level = 1 },
	{ config_id = 98061, gadget_id = 70220003, pos = { x = 2298.733, y = 210.010, z = -1175.429 }, rot = { x = 0.000, y = 265.403, z = 0.000 }, level = 1 },
	{ config_id = 98062, gadget_id = 70220055, pos = { x = 2326.777, y = 211.469, z = -1186.763 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	{ config_id = 98063, gadget_id = 70220055, pos = { x = 2315.059, y = 208.419, z = -1147.031 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	{ config_id = 98064, gadget_id = 70220055, pos = { x = 2305.860, y = 211.571, z = -1154.029 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 },
	{ config_id = 98065, gadget_id = 70220055, pos = { x = 2296.671, y = 212.088, z = -1153.456 }, rot = { x = 0.000, y = 0.000, z = 0.000 }, level = 1 }
}

-- 区域
regions = {
	{ config_id = 98011, shape = RegionShape.SPHERE, radius = 10.7, pos = { x = 2221.882, y = 226.264, z = -1146.372 } },
	{ config_id = 98012, shape = RegionShape.SPHERE, radius = 14.5, pos = { x = 2189.570, y = 229.396, z = -1095.766 } },
	{ config_id = 98013, shape = RegionShape.SPHERE, radius = 16.4, pos = { x = 2171.129, y = 200.048, z = -1001.037 } },
	{ config_id = 98014, shape = RegionShape.SPHERE, radius = 5, pos = { x = 2114.274, y = 222.367, z = -1022.620 } }
}

-- 触发器
triggers = {
	{ config_id = 1098007, name = "GADGET_CREATE_98007", event = EventType.EVENT_GADGET_CREATE, source = "", condition = "condition_EVENT_GADGET_CREATE_98007", action = "action_EVENT_GADGET_CREATE_98007", trigger_count = 0 },
	{ config_id = 1098008, name = "SELECT_OPTION_98008", event = EventType.EVENT_SELECT_OPTION, source = "", condition = "condition_EVENT_SELECT_OPTION_98008", action = "action_EVENT_SELECT_OPTION_98008" },
	{ config_id = 1098009, name = "CHALLENGE_SUCCESS_98009", event = EventType.EVENT_CHALLENGE_SUCCESS, source = "666", condition = "", action = "action_EVENT_CHALLENGE_SUCCESS_98009" },
	{ config_id = 1098010, name = "CHALLENGE_FAIL_98010", event = EventType.EVENT_CHALLENGE_FAIL, source = "666", condition = "", action = "action_EVENT_CHALLENGE_FAIL_98010", trigger_count = 0 },
	{ config_id = 1098011, name = "ENTER_REGION_98011", event = EventType.EVENT_ENTER_REGION, source = "", condition = "condition_EVENT_ENTER_REGION_98011", action = "action_EVENT_ENTER_REGION_98011" },
	{ config_id = 1098012, name = "ENTER_REGION_98012", event = EventType.EVENT_ENTER_REGION, source = "", condition = "condition_EVENT_ENTER_REGION_98012", action = "action_EVENT_ENTER_REGION_98012" },
	{ config_id = 1098013, name = "ENTER_REGION_98013", event = EventType.EVENT_ENTER_REGION, source = "", condition = "condition_EVENT_ENTER_REGION_98013", action = "action_EVENT_ENTER_REGION_98013" },
	{ config_id = 1098014, name = "ENTER_REGION_98014", event = EventType.EVENT_ENTER_REGION, source = "", condition = "", action = "", tag = "666" }
}

-- 变量
variables = {
}

--================================================================
-- 
-- 初始化配置
-- 
--================================================================

-- 初始化时创建
init_config = {
	suite = 1,
	end_suite = 0,
	rand_suite = false
}

--================================================================
-- 
-- 小组配置
-- 
--================================================================

suites = {
	{
		-- suite_id = 1,
		-- description = ,
		monsters = { },
		gadgets = { 98001 },
		regions = { 98014 },
		triggers = { "GADGET_CREATE_98007", "SELECT_OPTION_98008", "CHALLENGE_SUCCESS_98009", "CHALLENGE_FAIL_98010", "ENTER_REGION_98014" },
		rand_weight = 100
	},
	{
		-- suite_id = 2,
		-- description = ,
		monsters = { },
		gadgets = { 98002 },
		regions = { 98011 },
		triggers = { "ENTER_REGION_98011" },
		rand_weight = 100
	},
	{
		-- suite_id = 3,
		-- description = ,
		monsters = { },
		gadgets = { 98003 },
		regions = { 98012 },
		triggers = { "ENTER_REGION_98012" },
		rand_weight = 100
	},
	{
		-- suite_id = 4,
		-- description = ,
		monsters = { },
		gadgets = { 98004, 98005 },
		regions = { 98013 },
		triggers = { "ENTER_REGION_98013" },
		rand_weight = 100
	},
	{
		-- suite_id = 5,
		-- description = ,
		monsters = { },
		gadgets = { 98006 },
		regions = { },
		triggers = { },
		rand_weight = 100
	},
	{
		-- suite_id = 6,
		-- description = ,
		monsters = { },
		gadgets = { },
		regions = { },
		triggers = { },
		rand_weight = 100
	},
	{
		-- suite_id = 7,
		-- description = ,
		monsters = { },
		gadgets = { 98030, 98031, 98032, 98033, 98034, 98054, 98056, 98057, 98058 },
		regions = { },
		triggers = { },
		rand_weight = 100
	},
	{
		-- suite_id = 8,
		-- description = ,
		monsters = { },
		gadgets = { 98045, 98046, 98047, 98048, 98049, 98050, 98051, 98052, 98053, 98059, 98060, 98061 },
		regions = { },
		triggers = { },
		rand_weight = 100
	},
	{
		-- suite_id = 9,
		-- description = ,
		monsters = { },
		gadgets = { 98035, 98036, 98037, 98038, 98039, 98040, 98041, 98042, 98043, 98044, 98055, 98062, 98063, 98064, 98065 },
		regions = { },
		triggers = { },
		rand_weight = 100
	},
	{
		-- suite_id = 10,
		-- description = 这组不刷,
		monsters = { },
		gadgets = { 98015, 98016, 98017, 98018, 98019, 98020, 98021, 98022 },
		regions = { },
		triggers = { },
		rand_weight = 100
	}
}

--================================================================
-- 
-- 触发器
-- 
--================================================================

-- 触发条件
function condition_EVENT_GADGET_CREATE_98007(context, evt)
	if 98001 ~= evt.param1 then
		return false
	end
	
	return true
end

-- 触发操作
function action_EVENT_GADGET_CREATE_98007(context, evt)
	-- 设置操作台选项
	if 0 ~= ScriptLib.SetWorktopOptionsByGroupId(context, 111101098, 98001, {2}) then
	  ScriptLib.PrintContextLog(context, "@@ LUA_WARNING : set_wok_options_by_configid")
		return -1
	end
	
	return 0
end

-- 触发条件
function condition_EVENT_SELECT_OPTION_98008(context, evt)
	-- 判断是gadgetid 98001 option_id 2
	if 98001 ~= evt.param1 then
		return false	
	end
	
	if 2 ~= evt.param2 then
		return false
	end
	
	
	return true
end

-- 触发操作
function action_EVENT_SELECT_OPTION_98008(context, evt)
	-- 添加suite2的新内容
	    ScriptLib.AddExtraGroupSuite(context, 111101098, 2)
	
	-- 创建编号为666（该挑战的识别id),挑战内容为127的区域挑战，具体参数填写方式，见DungeonChallengeData表中的注释，所有填写的值都必须是int类型
	if 0 ~= ScriptLib.ActiveChallenge(context, 666, 127, 180, 4, 666, 1) then
	  ScriptLib.PrintContextLog(context, "@@ LUA_WARNING : active_challenge")
		return -1
	end
	
	-- 添加suite6的新内容
	    ScriptLib.AddExtraGroupSuite(context, 111101098, 6)
	
	-- 添加suite7的新内容
	    ScriptLib.AddExtraGroupSuite(context, 111101098, 7)
	
	-- 添加suite8的新内容
	    ScriptLib.AddExtraGroupSuite(context, 111101098, 8)
	
	-- 添加suite9的新内容
	    ScriptLib.AddExtraGroupSuite(context, 111101098, 9)
	
	-- 添加suite10的新内容
	    ScriptLib.AddExtraGroupSuite(context, 111101098, 10)
	
	return 0
end

-- 触发操作
function action_EVENT_CHALLENGE_SUCCESS_98009(context, evt)
	-- 删除suite5的所有内容
	    ScriptLib.RemoveExtraGroupSuite(context, 111101098, 5)
	
	return 0
end

-- 触发操作
function action_EVENT_CHALLENGE_FAIL_98010(context, evt)
		-- 重新生成指定group，指定suite
		if 0 ~= ScriptLib.RefreshGroup(context, { group_id = 111101098, suite = 1 }) then
	    ScriptLib.PrintContextLog(context, "@@ LUA_WARNING : refresh_group_to_suite")
			return -1
		end
	
	return 0
end

-- 触发条件
function condition_EVENT_ENTER_REGION_98011(context, evt)
	if evt.param1 ~= 98011 then return false end
	
	-- 判断角色数量不少于1
	if ScriptLib.GetRegionEntityCount(context, { region_eid = evt.source_eid, entity_type = EntityType.AVATAR }) < 1 then
		return false
	end
	
	return true
end

-- 触发操作
function action_EVENT_ENTER_REGION_98011(context, evt)
	-- 添加suite3的新内容
	    ScriptLib.AddExtraGroupSuite(context, 111101098, 3)
	
	return 0
end

-- 触发条件
function condition_EVENT_ENTER_REGION_98012(context, evt)
	if evt.param1 ~= 98012 then return false end
	
	-- 判断角色数量不少于1
	if ScriptLib.GetRegionEntityCount(context, { region_eid = evt.source_eid, entity_type = EntityType.AVATAR }) < 1 then
		return false
	end
	
	return true
end

-- 触发操作
function action_EVENT_ENTER_REGION_98012(context, evt)
	-- 添加suite4的新内容
	    ScriptLib.AddExtraGroupSuite(context, 111101098, 4)
	
	return 0
end

-- 触发条件
function condition_EVENT_ENTER_REGION_98013(context, evt)
	if evt.param1 ~= 98013 then return false end
	
	-- 判断角色数量不少于1
	if ScriptLib.GetRegionEntityCount(context, { region_eid = evt.source_eid, entity_type = EntityType.AVATAR }) < 1 then
		return false
	end
	
	return true
end

-- 触发操作
function action_EVENT_ENTER_REGION_98013(context, evt)
	-- 添加suite5的新内容
	    ScriptLib.AddExtraGroupSuite(context, 111101098, 5)
	
	-- 删除suite2的所有内容
	    ScriptLib.RemoveExtraGroupSuite(context, 111101098, 2)
	
	-- 删除suite3的所有内容
	    ScriptLib.RemoveExtraGroupSuite(context, 111101098, 3)
	
	return 0
end